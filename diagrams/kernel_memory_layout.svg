<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg
   viewBox="0 0 800 650"
   version="1.1"
   id="svg60"
   sodipodi:docname="kernel_memory_layout.svg"
   inkscape:version="1.4 (86a8ad7, 2024-10-11)"
   inkscape:export-filename="..\images\kernel_memory_layout.webp"
   inkscape:export-xdpi="96"
   inkscape:export-ydpi="96"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview60"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:zoom="1.3894894"
     inkscape:cx="400.147"
     inkscape:cy="316.30325"
     inkscape:window-width="1920"
     inkscape:window-height="1057"
     inkscape:window-x="-8"
     inkscape:window-y="-8"
     inkscape:window-maximized="1"
     inkscape:current-layer="svg60" />
  <defs
     id="defs12">
    <linearGradient
       id="kernelGradient"
       x1="0%"
       y1="0%"
       x2="0%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#ff5252;stop-opacity:1"
         id="stop1" />
      <stop
         offset="100%"
         style="stop-color:#c62828;stop-opacity:1"
         id="stop2" />
    </linearGradient>
    <linearGradient
       id="userGradient"
       x1="0%"
       y1="0%"
       x2="0%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#66bb6a;stop-opacity:1"
         id="stop3" />
      <stop
         offset="100%"
         style="stop-color:#2e7d32;stop-opacity:1"
         id="stop4" />
    </linearGradient>
    <linearGradient
       id="directMapGradient"
       x1="0%"
       y1="0%"
       x2="0%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#ff6b6b;stop-opacity:1"
         id="stop5" />
      <stop
         offset="100%"
         style="stop-color:#ee5a24;stop-opacity:1"
         id="stop6" />
    </linearGradient>
    <linearGradient
       id="vmallocGradient"
       x1="0%"
       y1="0%"
       x2="0%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#ff9ff3;stop-opacity:1"
         id="stop7" />
      <stop
         offset="100%"
         style="stop-color:#f368e0;stop-opacity:1"
         id="stop8" />
    </linearGradient>
    <linearGradient
       id="moduleGradient"
       x1="0%"
       y1="0%"
       x2="0%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#feca57;stop-opacity:1"
         id="stop9" />
      <stop
         offset="100%"
         style="stop-color:#ff9ff3;stop-opacity:1"
         id="stop10" />
    </linearGradient>
    <linearGradient
       id="kernelTextGradient"
       x1="0%"
       y1="0%"
       x2="0%"
       y2="100%">
      <stop
         offset="0%"
         style="stop-color:#48dbfb;stop-opacity:1"
         id="stop11" />
      <stop
         offset="100%"
         style="stop-color:#0abde3;stop-opacity:1"
         id="stop12" />
    </linearGradient>
    <linearGradient
       id="textSegmentGradient"
       x1="3.7308383"
       y1="24.190274"
       x2="3.7308383"
       y2="103.12696"
       gradientTransform="matrix(2.2009415,0,0,0.23426911,579.63165,223.79699)"
       gradientUnits="userSpaceOnUse">
      <stop
         offset="0%"
         style="stop-color:#4CAF50;stop-opacity:1"
         id="stop1-5" />
      <stop
         offset="100%"
         style="stop-color:#2E7D32;stop-opacity:1"
         id="stop2-7" />
    </linearGradient>
    <linearGradient
       id="rodataSegmentGradient"
       x1="3.7308383"
       y1="113.31234"
       x2="3.7308383"
       y2="192.24902"
       gradientTransform="matrix(2.2009415,0,0,0.23426911,579.63165,223.79699)"
       gradientUnits="userSpaceOnUse">
      <stop
         offset="0%"
         style="stop-color:#2196F3;stop-opacity:1"
         id="stop3-5" />
      <stop
         offset="100%"
         style="stop-color:#1976D2;stop-opacity:1"
         id="stop4-4" />
    </linearGradient>
    <linearGradient
       id="dataSegmentGradient"
       x1="3.7308383"
       y1="202.4344"
       x2="3.7308383"
       y2="281.37108"
       gradientTransform="matrix(2.2009415,0,0,0.23426911,579.63165,223.79699)"
       gradientUnits="userSpaceOnUse">
      <stop
         offset="0%"
         style="stop-color:#FF9800;stop-opacity:1"
         id="stop5-1" />
      <stop
         offset="100%"
         style="stop-color:#F57C00;stop-opacity:1"
         id="stop6-2" />
    </linearGradient>
    <linearGradient
       id="bssSegmentGradient"
       x1="3.7308383"
       y1="291.55646"
       x2="3.7308383"
       y2="370.49314"
       gradientTransform="matrix(2.2009415,0,0,0.23426911,579.63165,223.79699)"
       gradientUnits="userSpaceOnUse">
      <stop
         offset="0%"
         style="stop-color:#9C27B0;stop-opacity:1"
         id="stop7-0" />
      <stop
         offset="100%"
         style="stop-color:#7B1FA2;stop-opacity:1"
         id="stop8-0" />
    </linearGradient>
  </defs>
  <!-- Title -->
  <text
     x="400"
     y="20"
     font-family="Arial"
     font-size="16"
     font-weight="bold"
     text-anchor="middle"
     fill="#333"
     id="text12">
    Layout Completo de Memória Virtual **Linux** x86_64
  </text>
  <!-- Left Container - Overall Layout -->
  <rect
     x="20"
     y="40"
     width="220"
     height="480"
     fill="#f8f9fa"
     stroke="#333"
     stroke-width="2"
     rx="8"
     id="rect12" />
  <text
     x="130"
     y="60"
     font-family="Arial"
     font-size="12"
     font-weight="bold"
     text-anchor="middle"
     fill="#333"
     id="text13">
    Visão Geral
  </text>
  <!-- `kernel` Space (Left) -->
  <rect
     x="30"
     y="70"
     width="200"
     height="90"
     fill="url(#kernelGradient)"
     stroke="#333"
     stroke-width="1"
     rx="4"
     id="rect13" />
  <text
     x="130"
     y="90"
     font-family="Arial"
     font-size="11"
     font-weight="bold"
     text-anchor="middle"
     fill="white"
     id="text14">Kernel Space</text>
  <text
     x="35"
     y="105"
     font-family="mono"
     font-size="9"
     fill="white"
     id="text15"
     style="fill:#333333">0xffff800000000000</text>
  <text
     x="35"
     y="118"
     font-family="mono"
     font-size="9"
     fill="white"
     id="text16"
     style="fill:#333333">0xffffffffffffffff</text>
  <text
     x="35"
     y="135"
     font-family="Arial"
     font-size="8"
     fill="white"
     id="text17">• Direct mapping</text>
  <text
     x="35"
     y="145"
     font-family="Arial"
     font-size="8"
     fill="white"
     id="text18">• vmalloc/modules</text>
  <text
     x="35"
     y="155"
     font-family="Arial"
     font-size="8"
     fill="white"
     id="text19">• `kernel` text/data</text>
  <!-- Non-canonical gap (Left) -->
  <rect
     x="30"
     y="165"
     width="200"
     height="25"
     fill="#6c757d"
     stroke="#333"
     stroke-width="1"
     rx="4"
     id="rect19" />
  <text
     x="130"
     y="180"
     font-family="Arial"
     font-size="10"
     font-weight="bold"
     text-anchor="middle"
     fill="white"
     id="text20">Non-canonical</text>
  <!-- User Space (Left) -->
  <rect
     x="30"
     y="195"
     width="200"
     height="300"
     fill="url(#userGradient)"
     stroke="#333"
     stroke-width="1"
     rx="4"
     id="rect20" />
  <text
     x="130"
     y="215"
     font-family="Arial"
     font-size="11"
     font-weight="bold"
     text-anchor="middle"
     fill="white"
     id="text21">User Space</text>
  <text
     x="35"
     y="235"
     font-family="mono"
     font-size="9"
     fill="white"
     id="text22"
     style="fill:#333333">0x00007fffffffffff</text>
  <!-- User space sections (simplified) -->
  <rect
     x="40"
     y="250"
     width="180"
     height="25"
     fill="#4caf50"
     stroke="#2e7d32"
     stroke-width="1"
     rx="3"
     id="rect22" />
  <text
     x="45"
     y="265"
     font-family="Arial"
     font-size="9"
     font-weight="bold"
     fill="white"
     id="text23">Stack</text>
  <rect
     x="40"
     y="280"
     width="180"
     height="25"
     fill="#43a047"
     stroke="#2e7d32"
     stroke-width="1"
     rx="3"
     id="rect23" />
  <text
     x="45"
     y="295"
     font-family="Arial"
     font-size="9"
     font-weight="bold"
     fill="white"
     id="text24">Libs/mmap</text>
  <rect
     x="40"
     y="310"
     width="180"
     height="25"
     fill="#388e3c"
     stroke="#2e7d32"
     stroke-width="1"
     rx="3"
     id="rect24" />
  <text
     x="45"
     y="325"
     font-family="Arial"
     font-size="9"
     font-weight="bold"
     fill="white"
     id="text25">Heap</text>
  <rect
     x="40"
     y="340"
     width="180"
     height="25"
     fill="#2e7d32"
     stroke="#2e7d32"
     stroke-width="1"
     rx="3"
     id="rect25" />
  <text
     x="45"
     y="355"
     font-family="Arial"
     font-size="9"
     font-weight="bold"
     fill="white"
     id="text26">Data/BSS</text>
  <rect
     x="40"
     y="370"
     width="180"
     height="25"
     fill="#1b5e20"
     stroke="#2e7d32"
     stroke-width="1"
     rx="3"
     id="rect26" />
  <text
     x="45"
     y="385"
     font-family="Arial"
     font-size="9"
     font-weight="bold"
     fill="white"
     id="text27">Text</text>
  <rect
     x="40"
     y="400"
     width="180"
     height="90"
     fill="#263238"
     stroke="#2e7d32"
     stroke-width="1"
     rx="3"
     id="rect27" />
  <text
     x="130"
     y="420"
     font-family="Arial"
     font-size="9"
     font-weight="bold"
     text-anchor="middle"
     fill="white"
     id="text28">NULL/Reserved</text>
  <text
     x="130"
     y="440"
     font-family="mono"
     font-size="8"
     text-anchor="middle"
     fill="white"
     id="text29">0x0000000000000000</text>
  <!-- Right Container - `kernel` Space Detail -->
  <rect
     x="280.00232"
     y="40.002304"
     width="499.99539"
     height="582.68323"
     fill="#f8f9fa"
     stroke="#333333"
     stroke-width="2"
     rx="7.9999261"
     id="rect29" />
  <text
     x="530"
     y="60"
     font-family="Arial"
     font-size="12"
     font-weight="bold"
     text-anchor="middle"
     fill="#333"
     id="text30">
    Detalhamento do `kernel` Space
  </text>
  <!-- High Memory Address -->
  <text
     x="291.52048"
     y="90.32164"
     font-family="mono"
     font-size="10px"
     fill="#666"
     id="text31"
     style="fill:#333333">0xffffffffffffffff</text>
  <!-- Direct Mapping Region -->
  <rect
     x="290"
     y="95"
     width="480"
     height="120"
     fill="url(#directMapGradient)"
     stroke="#333"
     stroke-width="1"
     rx="4"
     id="rect31" />
  <text
     x="530"
     y="115"
     font-family="Arial"
     font-size="12"
     font-weight="bold"
     text-anchor="middle"
     fill="white"
     id="text32">
    Mapeamento Direto de Memória Física
  </text>
  <text
     x="295"
     y="135"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text33">• Mapeamento 1:1 da RAM física</text>
  <text
     x="295"
     y="150"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text34">• Endereço Virtual = Endereço Físico + PAGE_OFFSET</text>
  <text
     x="295"
     y="165"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text35">• Ideal para DMA e acesso de baixa latência</text>
  <text
     x="295"
     y="180"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text36">• Usado por kmalloc() - fisicamente contíguo</text>
  <text
     x="295"
     y="195"
     font-family="mono"
     font-size="9"
     fill="white"
     id="text37"
     style="fill:#333333">~0xffff888000000000 - 0xffffc87fffffffff</text>
  <!-- vmalloc Area -->
  <rect
     x="290"
     y="220"
     width="480"
     height="100"
     fill="url(#vmallocGradient)"
     stroke="#333"
     stroke-width="1"
     rx="4"
     id="rect37" />
  <text
     x="530"
     y="240"
     font-family="Arial"
     font-size="12"
     font-weight="bold"
     text-anchor="middle"
     fill="white"
     id="text38">
    Área vmalloc
  </text>
  <text
     x="295"
     y="260"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text39">• Virtualmente contíguo, fisicamente disperso</text>
  <text
     x="295"
     y="275"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text40">• Usado por vmalloc() - grandes alocações</text>
  <text
     x="295"
     y="290"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text41">• Maior flexibilidade, menor performance</text>
  <text
     x="295"
     y="305"
     font-family="mono"
     font-size="9"
     fill="white"
     id="text42"
     style="fill:#333333">~0xffffc90000000000 - 0xffffe8ffffffffff</text>
  <!-- `kernel` Modules Area -->
  <rect
     x="290"
     y="325"
     width="480"
     height="80"
     fill="url(#moduleGradient)"
     stroke="#333"
     stroke-width="1"
     rx="4"
     id="rect42" />
  <text
     x="530"
     y="345"
     font-family="Arial"
     font-size="12"
     font-weight="bold"
     text-anchor="middle"
     fill="white"
     id="text43">
    Área de Módulos do Kernel
  </text>
  <text
     x="295"
     y="365"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text44">• Código e dados de módulos (.ko files)</text>
  <text
     x="295"
     y="380"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text45">• Carregados dinamicamente com insmod</text>
  <text
     x="295"
     y="395"
     font-family="mono"
     font-size="9"
     fill="white"
     id="text46"
     style="fill:#4d4d4d">~0xffffffffa0000000 - 0xffffffffff5fffff</text>
  <!-- `kernel` Text/Data Area -->
  <rect
     x="290"
     y="410"
     width="480"
     height="100"
     fill="url(#kernelTextGradient)"
     stroke="#333"
     stroke-width="1"
     rx="4"
     id="rect46" />
  <text
     x="530"
     y="430"
     font-family="Arial"
     font-size="12"
     font-weight="bold"
     text-anchor="middle"
     fill="white"
     id="text47">
    `kernel` Text/Data (vmlinux)
  </text>
  <text
     x="295"
     y="450"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text48">• Código do `kernel` (.text segment)</text>
  <text
     x="295"
     y="465"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text49">• Dados inicializados (.data segment)</text>
  <text
     x="295"
     y="480"
     font-family="Arial"
     font-size="10"
     fill="white"
     id="text50">• Dados não inicializados (.bss segment)</text>
  <text
     x="295"
     y="495"
     font-family="mono"
     font-size="9"
     fill="white"
     id="text51"
     style="fill:#333333">~0xffffffff80000000 - 0xffffffffa0000000</text>
  <!-- KASLR/Security Features -->
  <rect
     x="290"
     y="520"
     width="480"
     height="85"
     fill="#ffc107"
     stroke="#333"
     stroke-width="1"
     rx="4"
     id="rect51" />
  <text
     x="530"
     y="540"
     font-family="Arial"
     font-size="12"
     font-weight="bold"
     text-anchor="middle"
     fill="#333"
     id="text52">
    Recursos de Segurança
  </text>
  <text
     x="295"
     y="560"
     font-family="Arial"
     font-size="10"
     fill="#333"
     id="text53">• KASLR: `kernel` Address Space Layout Randomization</text>
  <text
     x="295"
     y="575"
     font-family="Arial"
     font-size="10"
     fill="#333"
     id="text54">• SMEP/SMAP: Proteção contra execução/acesso user</text>
  <text
     x="295"
     y="590"
     font-family="Arial"
     font-size="10"
     fill="#333"
     id="text55">• Stack canaries e KPTI para mitigação de ataques</text>
  <!-- Low Memory Address -->
  <text
     x="291.52048"
     y="615.02112"
     font-family="mono"
     font-size="10px"
     fill="#666666"
     id="text56">0xffff800000000000</text>
  <!-- Arrow connecting the two views -->
  <path
     d="M 250 115 Q 265 115 280 115"
     stroke="#ff5252"
     stroke-width="3"
     fill="none"
     marker-end="url(#arrowhead)"
     id="path56" />
  <!-- Arrow marker definition -->
  <defs
     id="defs56">
    <marker
       id="arrowhead"
       markerWidth="10"
       markerHeight="7"
       refX="9"
       refY="3.5"
       orient="auto">
      <polygon
         points="0 0, 10 3.5, 0 7"
         fill="#ff5252"
         id="polygon56" />
    </marker>
  </defs>
  <!-- Legend -->
  <rect
     x="29.462433"
     y="538.06348"
     width="200"
     height="85"
     fill="#f0f0f0"
     stroke="#333333"
     stroke-width="1"
     rx="4"
     id="rect56" />
  <text
     x="129.46243"
     y="558.06348"
     font-family="Arial"
     font-size="11px"
     font-weight="bold"
     text-anchor="middle"
     fill="#333333"
     id="text57">Características</text>
  <text
     x="34.462433"
     y="578.06348"
     font-family="Arial"
     font-size="9px"
     fill="#333333"
     id="text58">• Endereçamento 48-bit</text>
  <text
     x="34.462433"
     y="593.06348"
     font-family="Arial"
     font-size="9px"
     fill="#333333"
     id="text59">• Page size: 4KB padrão</text>
  <text
     x="34.462433"
     y="608.06348"
     font-family="Arial"
     font-size="9px"
     fill="#333333"
     id="text60">• ASLR/KASLR ativo</text>
  <rect
     x="588.27515"
     y="229.76228"
     width="172.87067"
     height="17.895897"
     fill="url(#textSegmentGradient)"
     stroke="#333333"
     stroke-width="0.718062"
     rx="2.59306"
     id="rect8"
     style="fill:url(#textSegmentGradient);stroke-width:0.518;stroke-dasharray:none;opacity:0.56" />
  <text
     x="495.89032"
     y="289.49716"
     font-family="Arial"
     font-size="7.89868px"
     font-weight="bold"
     fill="#ffffff"
     id="text8"
     transform="scale(1.2037313,0.83075018)"
     style="stroke-width:0.718062">.text</text>
  <text
     x="524.61279"
     y="289.49716"
     font-family="Arial"
     font-size="6.46256px"
     fill="#ffffff"
     id="text9"
     transform="scale(1.2037313,0.83075018)"
     style="stroke-width:0.718062">código executável (R-X, NX=0)</text>
  <rect
     x="588.27515"
     y="250.64082"
     width="172.87067"
     height="17.895897"
     fill="url(#rodataSegmentGradient)"
     stroke="#333333"
     stroke-width="0.718062"
     rx="2.59306"
     id="rect9"
     style="fill:url(#rodataSegmentGradient);stroke-width:0.518;stroke-dasharray:none;opacity:0.56" />
  <text
     x="495.89032"
     y="314.6293"
     font-family="Arial"
     font-size="7.89868px"
     font-weight="bold"
     fill="#ffffff"
     id="text10"
     transform="scale(1.2037313,0.83075018)"
     style="stroke-width:0.718062">.rodata</text>
  <text
     x="531.7934"
     y="314.6293"
     font-family="Arial"
     font-size="6.46256px"
     fill="#ffffff"
     id="text11"
     transform="scale(1.2037313,0.83075018)"
     style="stroke-width:0.718062">dados somente leitura (R--, NX=1)</text>
  <rect
     x="588.27515"
     y="271.51938"
     width="172.87067"
     height="17.895897"
     fill="url(#dataSegmentGradient)"
     stroke="#333333"
     stroke-width="0.718062"
     rx="2.59306"
     id="rect11"
     style="fill:url(#dataSegmentGradient);stroke-width:0.518;stroke-dasharray:none;opacity:0.56" />
  <text
     x="495.89032"
     y="339.76147"
     font-family="Arial"
     font-size="7.89868px"
     font-weight="bold"
     fill="#ffffff"
     id="text12-1"
     transform="scale(1.2037313,0.83075018)"
     style="stroke-width:0.718062">.data</text>
  <text
     x="524.61279"
     y="339.76147"
     font-family="Arial"
     font-size="6.46256px"
     fill="#ffffff"
     id="text13-4"
     transform="scale(1.2037313,0.83075018)"
     style="stroke-width:0.718062">dados inicializados (RW-, NX=1)</text>
  <rect
     x="588.27515"
     y="292.39792"
     width="172.87067"
     height="17.895897"
     fill="url(#bssSegmentGradient)"
     stroke="#333333"
     stroke-width="0.718062"
     rx="2.59306"
     id="rect13-6"
     style="fill:url(#bssSegmentGradient);stroke-width:0.518;stroke-dasharray:none;opacity:0.56" />
  <text
     x="495.89032"
     y="364.89365"
     font-family="Arial"
     font-size="7.89868px"
     font-weight="bold"
     fill="#ffffff"
     id="text14-0"
     transform="scale(1.2037313,0.83075018)"
     style="stroke-width:0.718062">.bss</text>
  <text
     x="521.02246"
     y="364.89365"
     font-family="Arial"
     font-size="6.46256px"
     fill="#ffffff"
     id="text15-7"
     transform="scale(1.2037313,0.83075018)"
     style="stroke-width:0.718062">dados não inicializados (RW-, NX=1)</text>
  <text
     x="560.51587"
     y="380.69098"
     font-family="Arial"
     font-size="5.74449px"
     text-anchor="middle"
     fill="#666666"
     id="text16-1"
     transform="scale(1.2037313,0.83075018)"
     style="stroke-width:0.718062">Segmentos de cada módulo carregado</text>
</svg>
